<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[あずにゃんインフラ技術]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="http://pitekusu.github.io/"/>
  <updated>2015-05-21T07:03:15.000Z</updated>
  <id>http://pitekusu.github.io/</id>
  
  <author>
    <name><![CDATA[ウナギンチャク]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[ZFS on Linuxを仮想CentOS7上で検証した]]></title>
    <link href="http://pitekusu.github.io/2015/05/21/ZFS%20on%20Linux%E3%82%92%E4%BB%AE%E6%83%B3CentOS7%E4%B8%8A%E3%81%A7%E6%A4%9C%E8%A8%BC%E3%81%97%E3%81%A6%E3%81%BF%E3%81%9F/"/>
    <id>http://pitekusu.github.io/2015/05/21/ZFS on Linuxを仮想CentOS7上で検証してみた/</id>
    <published>2015-05-21T07:00:33.000Z</published>
    <updated>2015-05-21T07:03:15.000Z</updated>
    <content type="html"><![CDATA[<h2 id="はじめに">はじめに</h2><p>我が家のストレージサーバは<a href="http://www.freenas.org/" target="_blank" rel="external">FreeNAS</a>っていうソフトで運用してます。こいつはFreeBSD上で動くやつで、大変簡単に高価なストレージサーバレベルの機能を使用できる優れものです。FreeNASでは、RAIDを使うことはもちろんのこと、ZFSというファイルシステムを使用してファイルシステム上でRAID機能を実現することができます。今回はこのZFSについて簡単にメモしつつ、Linux上でZFSを使うことができるZFS on Linuxを使ってみようと思います。また、ZFSの機能を色々検証してみたのでそれもメモとして残しておきます。</p>
<a id="more"></a>
<h2 id="ZFSのすごいところ">ZFSのすごいところ</h2><p>ZFSはオラクルによって開発されたファイルシステムで、以下のような特徴があります。</p>
<ul>
<li>RAID機能がある</li>
<li>スナップショットが取れる</li>
<li>めっちゃ簡単、コマンド一行で終わる</li>
<li>ホットスペア対応</li>
<li>重複排除機能がある</li>
<li>割とメモリー容量を欲する</li>
</ul>
<p>実に便利そうですなあ。メモリー以外。メモリー容量が少ないとカーネルパニック起こすらしいので注意です。</p>
<h3 id="RAID-Zについて">RAID-Zについて</h3><p>ZFSが実装しているRAIDは、RAID-Zと呼ばれてます。<br>RAID-Z1がRAID5相当にあたります。いまはRAID-Z3までありトリプルパリティまでいけます。<br>あとRAIDでは「RAID5書き込みホール」問題というものがあります。データとパリティの間で不整合が起きる問題のことで、一見正常に動いているように見えていても徐々にデータが破壊されていくというオバケめいた問題です。この問題は停電やクラッシュで発生するようで、これを防ぐためにハードウェアRAIDではバッテリーを積んで防いでいるようです。おっかないです。RAID-Zを使用すると、この問題が起きないそうです。理由としてはコピーオンライト機能と可変ストライプ幅によるものと記載されていることが多いのですが、詳しいアーキテクチャについては難しくて謎です。特に可変ストライプ幅についてはいろいろ意見があるようなので特に謎です。</p>
<h2 id="ZFS_on_Linux">ZFS on Linux</h2><h3 id="今回の仮想マシン">今回の仮想マシン</h3><p>早速インストールしてみたいと思います。例にもよって仮想環境を構築しました。今回はこんな感じのスペックです。</p>
<ul>
<li>CPU：1ソケット2コア</li>
<li>ハードディスク：8GB×5本</li>
<li>NIC：VMXNET3</li>
<li>OS：CentOS7 最小インストール</li>
</ul>
<p>いつも邪魔ばっかしてくるSELinuxとかは既に止めてあります。<br>あ、あと下のコマンドラインに出てくる容量表示は今回の値とは異なってる場合があるんで気にしないでください。</p>
<h3 id="ZFS_on_Linuxのインストール">ZFS on Linuxのインストール</h3><p><a href="http://zfsonlinux.org/" target="_blank" rel="external">公式ページ</a>を参考にインストールしていきます。<br>まずはEPELという外部リポジトリをインストールします。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum localinstall --nogpgcheck https://download.fedoraproject.org/pub/epel/<span class="number">7</span>/x86_64/e/epel-release-<span class="number">7</span>-<span class="number">5</span>.noarch.rpm</span><br><span class="line">読み込んだプラグイン:fastestmirror</span><br><span class="line">epel-release-<span class="number">7</span>-<span class="number">5</span>.noarch.rpm                                                  |  <span class="number">14</span> kB  <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">/var/tmp/yum-root-<span class="number">1</span>fgyJT/epel-release-<span class="number">7</span>-<span class="number">5</span>.noarch.rpm を調べています: epel-release-<span class="number">7</span>-<span class="number">5</span>.noarch</span><br><span class="line">/var/tmp/yum-root-<span class="number">1</span>fgyJT/epel-release-<span class="number">7</span>-<span class="number">5</span>.noarch.rpm をインストール済みとして設定しています</span><br><span class="line">依存性の解決をしています</span><br><span class="line">--&gt; トランザクションの確認を実行しています。</span><br><span class="line">---&gt; パッケージ epel-release.noarch <span class="number">0</span>:<span class="number">7</span>-<span class="number">5</span> を インストール</span><br><span class="line">--&gt; 依存性解決を終了しました。</span><br><span class="line"></span><br><span class="line">依存性を解決しました</span><br><span class="line"></span><br><span class="line">====================================================================================================</span><br><span class="line"> Package                 アーキテクチャー  バージョン     リポジトリー                         容量</span><br><span class="line">====================================================================================================</span><br><span class="line">インストール中:</span><br><span class="line"> epel-release            noarch            <span class="number">7</span>-<span class="number">5</span>            /epel-release-<span class="number">7</span>-<span class="number">5</span>.noarch             <span class="number">24</span> k</span><br><span class="line"></span><br><span class="line">トランザクションの要約</span><br><span class="line">====================================================================================================</span><br><span class="line">インストール  <span class="number">1</span> パッケージ</span><br><span class="line"></span><br><span class="line">合計容量: <span class="number">24</span> k</span><br><span class="line">インストール容量: <span class="number">24</span> k</span><br><span class="line">Is this ok [y/d/N]: y</span><br><span class="line">Downloading packages:</span><br><span class="line">Running transaction check</span><br><span class="line">Running transaction <span class="built_in">test</span></span><br><span class="line">Transaction <span class="built_in">test</span> succeeded</span><br><span class="line">Running transaction</span><br><span class="line">  インストール中          : epel-release-<span class="number">7</span>-<span class="number">5</span>.noarch                                             <span class="number">1</span>/<span class="number">1</span></span><br><span class="line">  検証中                  : epel-release-<span class="number">7</span>-<span class="number">5</span>.noarch                                             <span class="number">1</span>/<span class="number">1</span></span><br><span class="line"></span><br><span class="line">インストール:</span><br><span class="line">  epel-release.noarch <span class="number">0</span>:<span class="number">7</span>-<span class="number">5</span></span><br><span class="line"></span><br><span class="line">完了しました!</span><br></pre></td></tr></table></figure>
<p>次に、ZFSのRPMパッケージをダウンロードします。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum localinstall --nogpgcheck http://archive.zfsonlinux.org/epel/zfs-release.el7.noarch.rpm</span><br><span class="line">読み込んだプラグイン:fastestmirror</span><br><span class="line">zfs-release.el7.noarch.rpm                                                   | <span class="number">4.3</span> kB  <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">/var/tmp/yum-root-<span class="number">1</span>fgyJT/zfs-release.el7.noarch.rpm を調べています: zfs-release-<span class="number">1</span>-<span class="number">2</span>.el7.centos.noarch</span><br><span class="line">/var/tmp/yum-root-<span class="number">1</span>fgyJT/zfs-release.el7.noarch.rpm をインストール済みとして設定しています</span><br><span class="line">依存性の解決をしています</span><br><span class="line">--&gt; トランザクションの確認を実行しています。</span><br><span class="line">---&gt; パッケージ zfs-release.noarch <span class="number">0</span>:<span class="number">1</span>-<span class="number">2</span>.el7.centos を インストール</span><br><span class="line">--&gt; 依存性解決を終了しました。</span><br><span class="line"></span><br><span class="line">依存性を解決しました</span><br><span class="line"></span><br><span class="line">====================================================================================================</span><br><span class="line"> Package             アーキテクチャー</span><br><span class="line">                                    バージョン                リポジトリー                     容量</span><br><span class="line">====================================================================================================</span><br><span class="line">インストール中:</span><br><span class="line"> zfs-release         noarch         <span class="number">1</span>-<span class="number">2</span>.el7.centos            /zfs-release.el7.noarch         <span class="number">2.4</span> k</span><br><span class="line"></span><br><span class="line">トランザクションの要約</span><br><span class="line">====================================================================================================</span><br><span class="line">インストール  <span class="number">1</span> パッケージ</span><br><span class="line"></span><br><span class="line">合計容量: <span class="number">2.4</span> k</span><br><span class="line">インストール容量: <span class="number">2.4</span> k</span><br><span class="line">Is this ok [y/d/N]: y</span><br><span class="line">Downloading packages:</span><br><span class="line">Running transaction check</span><br><span class="line">Running transaction <span class="built_in">test</span></span><br><span class="line">Transaction <span class="built_in">test</span> succeeded</span><br><span class="line">Running transaction</span><br><span class="line">  インストール中          : zfs-release-<span class="number">1</span>-<span class="number">2</span>.el7.centos.noarch                                   <span class="number">1</span>/<span class="number">1</span></span><br><span class="line">  検証中                  : zfs-release-<span class="number">1</span>-<span class="number">2</span>.el7.centos.noarch                                   <span class="number">1</span>/<span class="number">1</span></span><br><span class="line"></span><br><span class="line">インストール:</span><br><span class="line">  zfs-release.noarch <span class="number">0</span>:<span class="number">1</span>-<span class="number">2</span>.el7.centos</span><br><span class="line"></span><br><span class="line">完了しました!</span><br></pre></td></tr></table></figure>
<p>準備が整ったので、kernel-develというのとZFSをインストールします。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sudo yum install kernel-devel zfs</span></span><br><span class="line">読み込んだプラグイン:fastestmirror</span><br><span class="line">epel/x86_64/metalink                                                         | <span class="number">4.6</span> kB  <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">epel                                                                         | <span class="number">4.4</span> kB  <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">zfs                                                                          | <span class="number">2.9</span> kB  <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">(<span class="number">1</span>/<span class="number">3</span>): epel/x86_64/group_gz                                                  | <span class="number">169</span> kB  <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">(<span class="number">2</span>/<span class="number">3</span>): epel/x86_64/primary_db                                                | <span class="number">3.5</span> MB  <span class="number">00</span>:<span class="number">00</span>:<span class="number">01</span></span><br><span class="line">(<span class="number">3</span>/<span class="number">3</span>): zfs/x86_64/primary_db                                                 |  <span class="number">31</span> kB  <span class="number">00</span>:<span class="number">00</span>:<span class="number">01</span></span><br><span class="line">(<span class="number">1</span>/<span class="number">2</span>): epel/x86_64/updateinfo                                                | <span class="number">365</span> kB  <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">(<span class="number">2</span>/<span class="number">2</span>): epel/x86_64/pkgtags                                                   | <span class="number">1.5</span> MB  <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"></span><br><span class="line">～(省略)～</span><br><span class="line"></span><br><span class="line">  spl-dkms.noarch <span class="number">0</span>:<span class="number">0.6</span>.<span class="number">4.1</span>-<span class="number">1</span>.el7.centos            zfs-dkms.noarch <span class="number">0</span>:<span class="number">0.6</span>.<span class="number">4.1</span>-<span class="number">1</span>.el7.centos</span><br><span class="line"></span><br><span class="line">完了しました!</span><br></pre></td></tr></table></figure>
<p>インストール完了です。簡単です。</p>
<p>ちゃんとインストールできているか確認してみましょう。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ cat /proc/filesystems</span><br><span class="line">nodev   sysfs</span><br><span class="line">nodev   rootfs</span><br><span class="line">nodev   bdev</span><br><span class="line">nodev   proc</span><br><span class="line">nodev   cgroup</span><br><span class="line">nodev   cpuset</span><br><span class="line">nodev   tmpfs</span><br><span class="line">nodev   devtmpfs</span><br><span class="line">nodev   debugfs</span><br><span class="line">nodev   securityfs</span><br><span class="line">nodev   sockfs</span><br><span class="line">nodev   pipefs</span><br><span class="line">nodev   anon_inodefs</span><br><span class="line">nodev   configfs</span><br><span class="line">nodev   devpts</span><br><span class="line">nodev   ramfs</span><br><span class="line">nodev   hugetlbfs</span><br><span class="line">nodev   autofs</span><br><span class="line">nodev   pstore</span><br><span class="line">nodev   mqueue</span><br><span class="line">        xfs</span><br><span class="line">nodev   zfs</span><br></pre></td></tr></table></figure>
<p>一番下に<code>zfs</code>と表示されています。問題なさそうです。</p>
<h3 id="ZFSプール作成">ZFSプール作成</h3><p>まず、現状のデバイス状況を確認してみます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">$ parted <span class="operator">-l</span></span><br><span class="line">モデル: VMware Virtual disk (scsi)</span><br><span class="line">ディスク /dev/sda: <span class="number">17.2</span>GB</span><br><span class="line">セクタサイズ (論理/物理): <span class="number">512</span>B/<span class="number">512</span>B</span><br><span class="line">パーティションテーブル: msdos</span><br><span class="line">ディスクフラグ:</span><br><span class="line"></span><br><span class="line">番号  開始    終了    サイズ  タイプ   ファイルシステム  フラグ</span><br><span class="line"> <span class="number">1</span>    <span class="number">1049</span>kB  <span class="number">525</span>MB   <span class="number">524</span>MB   primary  xfs               boot</span><br><span class="line"> <span class="number">2</span>    <span class="number">525</span>MB   <span class="number">17.2</span>GB  <span class="number">16.7</span>GB  primary                    lvm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">エラー: /dev/sdb: ディスクラベルが認識できません。</span><br><span class="line">モデル: VMware Virtual disk (scsi)</span><br><span class="line">ディスク /dev/sdb: <span class="number">17.2</span>GB</span><br><span class="line">セクタサイズ (論理/物理): <span class="number">512</span>B/<span class="number">512</span>B</span><br><span class="line">パーティションテーブル: unknown</span><br><span class="line">ディスクフラグ:</span><br><span class="line"></span><br><span class="line">エラー: /dev/sdc: ディスクラベルが認識できません。</span><br><span class="line">モデル: VMware Virtual disk (scsi)</span><br><span class="line">ディスク /dev/sdc: <span class="number">17.2</span>GB</span><br><span class="line">セクタサイズ (論理/物理): <span class="number">512</span>B/<span class="number">512</span>B</span><br><span class="line">パーティションテーブル: unknown</span><br><span class="line">ディスクフラグ:</span><br><span class="line"></span><br><span class="line">エラー: /dev/sdd: ディスクラベルが認識できません。</span><br><span class="line">モデル: VMware Virtual disk (scsi)</span><br><span class="line">ディスク /dev/sdd: <span class="number">17.2</span>GB</span><br><span class="line">セクタサイズ (論理/物理): <span class="number">512</span>B/<span class="number">512</span>B</span><br><span class="line">パーティションテーブル: unknown</span><br><span class="line">ディスクフラグ:</span><br><span class="line"></span><br><span class="line">エラー: /dev/sde: ディスクラベルが認識できません。</span><br><span class="line">モデル: VMware Virtual disk (scsi)</span><br><span class="line">ディスク /dev/sde: <span class="number">17.2</span>GB</span><br><span class="line">セクタサイズ (論理/物理): <span class="number">512</span>B/<span class="number">512</span>B</span><br><span class="line">パーティションテーブル: unknown</span><br><span class="line">ディスクフラグ:</span><br><span class="line"></span><br><span class="line">モデル: Linux device-mapper (linear) (dm)</span><br><span class="line">ディスク /dev/mapper/centos-root: <span class="number">14.9</span>GB</span><br><span class="line">セクタサイズ (論理/物理): <span class="number">512</span>B/<span class="number">512</span>B</span><br><span class="line">パーティションテーブル: loop</span><br><span class="line">ディスクフラグ:</span><br><span class="line"></span><br><span class="line">番号  開始   終了    サイズ  ファイルシステム  フラグ</span><br><span class="line"> <span class="number">1</span>    <span class="number">0.00</span>B  <span class="number">14.9</span>GB  <span class="number">14.9</span>GB  xfs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">モデル: Linux device-mapper (linear) (dm)</span><br><span class="line">ディスク /dev/mapper/centos-swap: <span class="number">1720</span>MB</span><br><span class="line">セクタサイズ (論理/物理): <span class="number">512</span>B/<span class="number">512</span>B</span><br><span class="line">パーティションテーブル: loop</span><br><span class="line">ディスクフラグ:</span><br><span class="line"></span><br><span class="line">番号  開始   終了    サイズ  ファイルシステム  フラグ</span><br><span class="line"> <span class="number">1</span>    <span class="number">0.00</span>B  <span class="number">1720</span>MB  <span class="number">1720</span>MB  linux-swap(v1)</span><br></pre></td></tr></table></figure>
<p><code>sda</code>がLinuxがインストールされているデバイスのようです。<br><code>sdb</code>とか<code>sdc</code>がまだ何もフォーマットされてないディスクたちです。</p>
<p>さっそくZFSプールを作成してみます。<br>ZFSでは基本的に<code>zfs</code>コマンドか<code>zpool</code>コマンドしか使いません。単純明快なところが助かります。今回は調子に乗ってトリプルパリティであるRAID-Z3にします。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ zpool create tank raidz3 /dev/sdb /dev/sdc /dev/sdd /dev/sde /dev/sdf</span><br><span class="line">invalid vdev specification</span><br><span class="line">use <span class="string">'-f'</span> to override the following errors:</span><br><span class="line">/dev/sdb does not contain an EFI label but it may contain partition</span><br><span class="line">information <span class="keyword">in</span> the MBR.</span><br></pre></td></tr></table></figure>
<p>といった矢先にエラーが出た。EFIラベルが無いとかなんとかってかいてあります。なんか<code>-f</code>っていうオプションつけたらいけるって書いてあるのでやってみます。ちなみに<code>tank</code>というのはzfsでのプールにおける慣例的なディレクトリらしく、みんなそこにマウントするので私もそうします。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ zpool create tank raidz3 /dev/sdb /dev/sdc /dev/sdd /dev/sde /dev/sdf <span class="operator">-f</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>何のエラーなく終わりました。行けたのかしら。<br><code>zpool</code>コマンドで確認してみます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ zpool list</span><br><span class="line">NAME   SIZE  ALLOC   FREE  EXPANDSZ   FRAG    CAP  DEDUP  HEALTH  ALTROOT</span><br><span class="line">tank  <span class="number">63.5</span>G   <span class="number">100</span>K  <span class="number">63.5</span>G         -     <span class="number">0</span>%     <span class="number">0</span>%  <span class="number">1.00</span>x  ONLINE  -</span><br></pre></td></tr></table></figure>
<p>ちゃんとできてるっぽいです！</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ファイルシス            サイズ  使用  残り 使用% マウント位置</span><br><span class="line">/dev/mapper/centos-root    <span class="number">14</span>G  <span class="number">1.2</span>G   <span class="number">13</span>G    <span class="number">9</span>% /</span><br><span class="line">devtmpfs                  <span class="number">1.9</span>G     <span class="number">0</span>  <span class="number">1.9</span>G    <span class="number">0</span>% /dev</span><br><span class="line">tmpfs                     <span class="number">1.9</span>G     <span class="number">0</span>  <span class="number">1.9</span>G    <span class="number">0</span>% /dev/shm</span><br><span class="line">tmpfs                     <span class="number">1.9</span>G  <span class="number">8.5</span>M  <span class="number">1.9</span>G    <span class="number">1</span>% /run</span><br><span class="line">tmpfs                     <span class="number">1.9</span>G     <span class="number">0</span>  <span class="number">1.9</span>G    <span class="number">0</span>% /sys/fs/cgroup</span><br><span class="line">/dev/sda1                 <span class="number">497</span>M  <span class="number">151</span>M  <span class="number">347</span>M   <span class="number">31</span>% /boot</span><br><span class="line">tank                       <span class="number">16</span>G     <span class="number">0</span>   <span class="number">16</span>G    <span class="number">0</span>% /tank</span><br></pre></td></tr></table></figure>
<p>なんと今の一行のコマンド一つでマウントまでされました。簡単すぎて泣きそう。</p>
<p>以下のコマンドでZFSプールの状態を確認できます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ zpool status</span><br><span class="line">  pool: tank</span><br><span class="line"> state: ONLINE</span><br><span class="line">  scan: none requested</span><br><span class="line">config:</span><br><span class="line"></span><br><span class="line">        NAME        STATE     READ WRITE CKSUM</span><br><span class="line">        tank        ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">          raidz3-<span class="number">0</span>  ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sdb     ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sdc     ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sdd     ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sde     ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sdf     ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line"></span><br><span class="line">errors: No known data errors</span><br></pre></td></tr></table></figure>
<h3 id="重複排除の威力">重複排除の威力</h3><p>ZFSファイルシステムは、標準装備で重複排除機能を持っています。<br>ですが、デフォルトだと無効になっているのでまずは重複排除を有効化します。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ zfs <span class="built_in">set</span> dedup=on tank</span><br></pre></td></tr></table></figure>
<p>この状態で1GBのファイルを作成してみます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">if</span>=/dev/zero of=/tank/bigfile count=<span class="number">1024</span> bs=<span class="number">1</span>M</span><br></pre></td></tr></table></figure>
<p>サイズを確認してみます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ls -lha</span><br><span class="line">合計 <span class="number">1.0</span>G</span><br><span class="line">drwxr-xr-x   <span class="number">2</span> root root    <span class="number">3</span>  <span class="number">5</span>月 <span class="number">18</span> <span class="number">11</span>:<span class="number">57</span> .</span><br><span class="line">drwxr-xr-x. <span class="number">18</span> root root <span class="number">4.0</span>K  <span class="number">5</span>月 <span class="number">18</span> <span class="number">11</span>:<span class="number">44</span> ..</span><br><span class="line">-rw-r--r--   <span class="number">1</span> root root <span class="number">1.0</span>G  <span class="number">5</span>月 <span class="number">18</span> <span class="number">11</span>:<span class="number">57</span> bigfile</span><br></pre></td></tr></table></figure>
<p>ちゃんと1GBのファイルが作成されています。普通のファイルシステムであれば、ストレージの容量も1GB分減っているはずです。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ zpool list</span><br><span class="line">NAME   SIZE  ALLOC   FREE  EXPANDSZ   FRAG    CAP  DEDUP  HEALTH  ALTROOT</span><br><span class="line">tank  <span class="number">39.8</span>G   <span class="number">980</span>K  <span class="number">39.7</span>G         -     <span class="number">0</span>%     <span class="number">0</span>%  <span class="number">8192.00</span>x  ONLINE  -</span><br></pre></td></tr></table></figure>
<p>ALLOCというのが使用容量を示しています。なんと驚きの980KB!<br>今回の実験では高効率のゼロ埋めファイルですが、例えばメールデータのバックアップ先なんかにしたら文字情報しかない為に結構な高率で保存できると思います。</p>
<h3 id="ZFSスナップショット機能">ZFSスナップショット機能</h3><p>次はスナップショットという機能を使ってみます。<br>ファイルを削除する前とかにスナップショットを取っておいて、なんかミスったらすぐに元に戻せるっていう機能です。<br>まずはスナップショットを作成します。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ zfs snapshot tank@<span class="number">20150518</span></span><br></pre></td></tr></table></figure>
<p>スナップショットを一覧するコマンドがあるので確認してみます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ zfs list -t snapshot</span><br><span class="line">NAME            USED  AVAIL  REFER  MOUNTPOINT</span><br><span class="line">tank@<span class="number">20150518</span>  <span class="number">1020</span>M      -  <span class="number">1020</span>M  -</span><br></pre></td></tr></table></figure>
<p>ちゃんと作成されていました。1GB使用済みって表示されているので、そんなに容量喰うのかと思って<code>zpool list</code>を再確認。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ zpool list</span><br><span class="line">NAME   SIZE  ALLOC   FREE  EXPANDSZ   FRAG    CAP  DEDUP  HEALTH  ALTROOT</span><br><span class="line">tank  <span class="number">39.8</span>G  <span class="number">1.04</span>M  <span class="number">39.7</span>G         -     <span class="number">0</span>%     <span class="number">0</span>%  <span class="number">8192.00</span>x  ONLINE  -</span><br></pre></td></tr></table></figure>
<p>よかった、60KB位しか増えてないようです。とりあえずこれでスナップショットはとれました。<br>ここで作成した空ファイルを削除します。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ rm bigfile</span><br><span class="line">rm: 通常ファイル `bigfile<span class="string">' を削除しますか? y</span></span><br></pre></td></tr></table></figure>
<p>これで<code>bigfile</code>は消えてなくなりました。<br>かわりに<code>smallfile</code>というファイルを作成しておきます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ dd <span class="keyword">if</span>=/dev/zero of=/tank/smallfile count=<span class="number">128</span> bs=<span class="number">1</span>M</span><br><span class="line"><span class="number">128</span>+<span class="number">0</span> レコード入力</span><br><span class="line"><span class="number">128</span>+<span class="number">0</span> レコード出力</span><br><span class="line"><span class="number">134217728</span> バイト (<span class="number">134</span> MB) コピーされました、 <span class="number">0.142223</span> 秒、 <span class="number">944</span> MB/秒</span><br></pre></td></tr></table></figure>
<p>そして、さらにスナップショットを作成します。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ zfs snapshot tank@<span class="number">20150518</span>-<span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>なぜここでスナップショットを撮ったのか？<br>なんとZFSはスナップショット同士を比較することができるのです。！<br>以下のコマンドで何が変わったかを確認することができます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># zfs diff tank@20150518 tank@20150518-2</span></span><br><span class="line">M       /tank/</span><br><span class="line">-       /tank/bigfile</span><br><span class="line">+       /tank/smallfile</span><br></pre></td></tr></table></figure>
<p>表示された識別子で、何が変化したかを表してます。以下に表を置いておきます。</p>
<table>
<thead>
<tr>
<th style="text-align:center">識別子</th>
<th>意味</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">M</td>
<td>変更</td>
</tr>
<tr>
<td style="text-align:center">-</td>
<td>削除</td>
</tr>
<tr>
<td style="text-align:center">+</td>
<td>追加</td>
</tr>
<tr>
<td style="text-align:center">R</td>
<td>リネーム</td>
</tr>
</tbody>
</table>
<p><code>/tank</code>ディレクトリが変更され、<code>bigfile</code>が削除され<code>smallfile</code>が追加されたことがわかります。<br>もちろんロールバックも簡単です。やってみます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ zfs rollback tank@<span class="number">20150518</span></span><br></pre></td></tr></table></figure>
<p>ちゃんと元に戻ってるか確認してみます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ll</span><br><span class="line">合計 <span class="number">1044588</span></span><br><span class="line">-rw-r--r-- <span class="number">1</span> root root <span class="number">1073741824</span>  <span class="number">5</span>月 <span class="number">18</span> <span class="number">17</span>:<span class="number">19</span> bigfile</span><br></pre></td></tr></table></figure>
<p>完璧に元に戻りました。<strong><em>神ゲー</em></strong></p>
<h3 id="耐障害性の実験">耐障害性の実験</h3><p>RAID機能の力を見る時がやってきました。<br>あらためてZFSプールの状態を確認しておきます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ zpool status</span><br><span class="line">  pool: tank</span><br><span class="line"> state: ONLINE</span><br><span class="line">  scan: none requested</span><br><span class="line">config:</span><br><span class="line"></span><br><span class="line">        NAME        STATE     READ WRITE CKSUM</span><br><span class="line">        tank        ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">          raidz3-<span class="number">0</span>  ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sdb     ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sdc     ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sdd     ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sde     ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sdf     ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line"></span><br><span class="line">errors: No known data errors</span><br></pre></td></tr></table></figure>
<p>stateがONLINEと表示されています。問題ない状態です。</p>
<p>仮想マシンのいいところでHDDをぶっさすのも引っこ抜くものも自由自在です。さっそくハードディスクを1本引き抜いてみます。<br><img src="http://i.imgur.com/GzQs4tW.png" alt="Imgur"></p>
<p>再度ZFSプールの状態を確認します。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ zpool status</span><br><span class="line">  pool: tank</span><br><span class="line"> state: DEGRADED</span><br><span class="line">status: One or more devices could not be used because the label is missing or</span><br><span class="line">        invalid.  Sufficient replicas exist <span class="keyword">for</span> the pool to <span class="built_in">continue</span></span><br><span class="line">        functioning <span class="keyword">in</span> a degraded state.</span><br><span class="line">action: Replace the device using <span class="string">'zpool replace'</span>.</span><br><span class="line">   see: http://zfsonlinux.org/msg/ZFS-<span class="number">8000</span>-<span class="number">4</span>J</span><br><span class="line">  scan: none requested</span><br><span class="line">config:</span><br><span class="line"></span><br><span class="line">        NAME                      STATE     READ WRITE CKSUM</span><br><span class="line">        tank                      DEGRADED     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">          raidz3-<span class="number">0</span>                DEGRADED     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sdb                   ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sdc                   ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sdd                   ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            <span class="number">18248829720282346757</span>  FAULTED      <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>  was /dev/sde1</span><br><span class="line">            <span class="number">3834187477602051621</span>   UNAVAIL      <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>  was /dev/sdf1</span><br><span class="line"></span><br><span class="line">errors: No known data errors</span><br></pre></td></tr></table></figure>
<p>stateがDEGRADEDにかわっています。一台死んでやばい状態です。<br>この状態でファイルが参照できるか確認してみます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /tank/</span><br><span class="line">$ ll</span><br><span class="line">合計 <span class="number">1044588</span></span><br><span class="line">-rw-r--r-- <span class="number">1</span> root root <span class="number">1073741824</span>  <span class="number">5</span>月 <span class="number">18</span> <span class="number">17</span>:<span class="number">19</span> bigfile</span><br></pre></td></tr></table></figure>
<p>問題なく参照できるようです。<br>vSphereクライアントから新しいハードディスクを追加して<code>parted -l</code>を確認します。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ parted <span class="operator">-l</span></span><br><span class="line">～（省略）～</span><br><span class="line">エラー: /dev/sde: ディスクラベルが認識できません。</span><br><span class="line">モデル: VMware Virtual disk (scsi)</span><br><span class="line">ディスク /dev/sde: <span class="number">8590</span>MB</span><br><span class="line">セクタサイズ (論理/物理): <span class="number">512</span>B/<span class="number">512</span>B</span><br><span class="line">パーティションテーブル: unknown</span><br><span class="line">ディスクフラグ:</span><br></pre></td></tr></table></figure>
<p>一台フォーマットしていないディスクが見えてきました。こいつをZFSプールに参加させます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ zpool replace tank /dev/sde <span class="operator">-f</span></span><br></pre></td></tr></table></figure>
<p>からのZFSプールの状態確認。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ zpool status</span><br><span class="line">  pool: tank</span><br><span class="line"> state: ONLINE</span><br><span class="line">  scan: none requested</span><br><span class="line">config:</span><br><span class="line"></span><br><span class="line">        NAME        STATE     READ WRITE CKSUM</span><br><span class="line">        tank        ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">          raidz3-<span class="number">0</span>  ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sdb     ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sdc     ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sdd     ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sde     ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">            sdf     ONLINE       <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>エラーが無くなりました。<br>パーフェクトだにゃん・・・</p>
<h3 id="おわり">おわり</h3><p>素晴らしいZFSでした。非力なマシンだとかなりパフォーマンスが落ちるそうですが、マシンパワーに自信ニキであれば相当なパフォーマンスを発揮するそうです。耐障害性、堅牢性だけじゃなくて高速化を図るテクノロジーもいっぱい搭載してるらしい。<br>ちなみにホットスペアも検証してみました。そうしたらZFSファイルシステムが<strong><em>壊れた。</em></strong>しにてえ！以上です。</p>
<h3 id="参考サイト様">参考サイト様</h3><blockquote>
<p>SIOS “OSSよろず” ブログ出張所<br><a href="http://sios-oss.blogspot.jp/2012/02/zfs-on-linux1zfs-on-linux.html" target="_blank" rel="external">http://sios-oss.blogspot.jp/2012/02/zfs-on-linux1zfs-on-linux.html</a></p>
<p>私をペロペロするがよい<br><a href="http://lazy-dog.hatenablog.com/entry/2014/08/17/033038" target="_blank" rel="external">http://lazy-dog.hatenablog.com/entry/2014/08/17/033038</a></p>
<p>メモ帳みたいなもの<br><a href="http://nsrzakki.hateblo.jp/entry/2013/04/09/010854" target="_blank" rel="external">http://nsrzakki.hateblo.jp/entry/2013/04/09/010854</a></p>
<p>Life with IT<br><a href="http://l-w-i.net/t/solaris/zfs_001.txt" target="_blank" rel="external">http://l-w-i.net/t/solaris/zfs_001.txt</a></p>
<p>ADWAYS ENGINEERS BLOG<br><a href="http://blog.engineer.adways.net/archives/31692610.html" target="_blank" rel="external">http://blog.engineer.adways.net/archives/31692610.html</a></p>
<p>[[zfs コマンド]] メモとかメモのようなものとか（By ルーキーの中のひと)<br><a href="http://wiki.rookie-inc.com/serverapps/zfs/command" target="_blank" rel="external">http://wiki.rookie-inc.com/serverapps/zfs/command</a></p>
<p>hirotomium.com<br><a href="http://hirotomium.com/memories/2011/11/zfsreplace.php" target="_blank" rel="external">http://hirotomium.com/memories/2011/11/zfsreplace.php</a></p>
</blockquote>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="はじめに">はじめに</h2><p>我が家のストレージサーバは<a href="http://www.freenas.org/">FreeNAS</a>っていうソフトで運用してます。こいつはFreeBSD上で動くやつで、大変簡単に高価なストレージサーバレベルの機能を使用できる優れものです。FreeNASでは、RAIDを使うことはもちろんのこと、ZFSというファイルシステムを使用してファイルシステム上でRAID機能を実現することができます。今回はこのZFSについて簡単にメモしつつ、Linux上でZFSを使うことができるZFS on Linuxを使ってみようと思います。また、ZFSの機能を色々検証してみたのでそれもメモとして残しておきます。</p>]]>
    
    </summary>
    
      <category term="Linux" scheme="http://pitekusu.github.io/tags/Linux/"/>
    
      <category term="RAID" scheme="http://pitekusu.github.io/tags/RAID/"/>
    
      <category term="ZFS" scheme="http://pitekusu.github.io/tags/ZFS/"/>
    
      <category term="技術" scheme="http://pitekusu.github.io/categories/%E6%8A%80%E8%A1%93/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[GitHubとHexoが火を噴いた(第4回)]]></title>
    <link href="http://pitekusu.github.io/2015/05/14/GitHub%E3%81%A8Hexo%E3%81%8C%E7%81%AB%E3%82%92%E5%99%B4%E3%81%84%E3%81%9F4/"/>
    <id>http://pitekusu.github.io/2015/05/14/GitHubとHexoが火を噴いた4/</id>
    <published>2015-05-14T01:46:33.000Z</published>
    <updated>2015-05-14T05:53:21.000Z</updated>
    <content type="html"><![CDATA[<h2 id="はじめに">はじめに</h2><p><a href="http://pitekusu.github.io/2015/05/08/GitHub%E3%81%A8Hexo%E3%81%8C%E7%81%AB%E3%82%92%E5%99%B4%E3%81%84%E3%81%9F3/" target="_blank" rel="external">前回</a>で、  Hexoをインストールする準備が終わりました。いよいよHexoをインストールかと思いきや、Github Pagesの作成をしてなかったので、まずそれをやりたいと思います。</p>
<a id="more"></a>
<h2 id="Github_Pagesの作成">Github Pagesの作成</h2><h3 id="サインアップ">サインアップ</h3><p><img src="http://i.imgur.com/KQ5FPgc.png" alt="Imgur"><br><a href="https://github.com/" target="_blank" rel="external">Github</a>にアクセスして、右上の”Sign up”をクリックします。<br>そうするとパスワードやらユーザ名やら入れる画面になるので、入力します。<br>ここで作成するユーザ名が、ウェブページのURLに関わってくるのであんまり適当なのにするとショックでかいです。azunyanのような超大人気ユーザ名は基本的に取れないので悲しみに暮れるばかりです。<br><img src="http://i.imgur.com/Mv1dsj5.png" alt="Imgur"><br>有料プランが提示されます。プライベートリポジトリがほしい人は有料になりますが、Github Pages目的であればいらないので <strong>Free</strong> を選択しておきます。<br><img src="http://i.imgur.com/EHh8WOj.png" alt="Imgur"><br>これで確か登録したメールアドレス宛てに確認のメールが来るので、認証しておきます。サインアップは終了です。簡単すぎワロタ</p>
<h3 id="リポジトリ作成">リポジトリ作成</h3><p>右下の方に <strong>New Repository</strong> という緑色のボタンがあるので、これをクリックします。<br><img src="http://i.imgur.com/CatTTuc.png" alt="Imgur"><br><strong>Repository name</strong> に、 <code>ユーザ名.github.io</code> と入力します。このリポジトリ名にするとGithub Pages用のリポジトリになります。<br><img src="http://i.imgur.com/7qEL0eP.png" alt="Imgur"><br>このページが表示されたらリポジトリの作成も完了です。簡単すぎワロタ<br><img src="http://i.imgur.com/Lm6GlRG.png" alt="Imgur"></p>
<h3 id="SSH公開鍵登録">SSH公開鍵登録</h3><p>GithubにSSH公開鍵を登録しないといけないそうなので、登録しておきます。こないだ作ったHexo用サーバにアクセスして、以下のコマンドでSSH公開鍵を生成します。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/root/.ssh/id_rsa):(エンター)</span><br><span class="line">Created directory <span class="string">'/root/.ssh'</span>.</span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase):（エンター）</span><br><span class="line">Enter same passphrase again:（エンター）</span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line"><span class="number">7</span>e:<span class="number">05</span>:<span class="number">47</span>:a3:c1:<span class="number">5</span>c:<span class="number">13</span>:ee:ef:e7:be:<span class="number">16</span>:<span class="number">01</span>:ce:<span class="number">54</span>:f1 root@localhost.localdomain</span><br><span class="line">The key<span class="string">'s randomart image is:</span><br><span class="line">+--[ RSA 2048]----+</span><br><span class="line">|         o..*..o.|</span><br><span class="line">|          o= =  .|</span><br><span class="line">|          o * . E|</span><br><span class="line">|           + o . |</span><br><span class="line">|        S   o   .|</span><br><span class="line">|       .   . . . |</span><br><span class="line">|        . .   . .|</span><br><span class="line">|         .   . ..|</span><br><span class="line">|              o=+|</span><br><span class="line">+-----------------+</span><br><span class="line">$</span></span><br></pre></td></tr></table></figure>
<p>公開鍵が作成されたので、作成された鍵を確認します。この鍵をコピーしておきます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ more /root/.ssh/id_rsa.pub</span><br><span class="line">ssh-rsa AAAAB ～省略～ SI4uE0lw5 root@localhost.localdomain</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>Githubにこの鍵を登録します。Githubの<a href="https://github.com/settings/profile" target="_blank" rel="external">設定ページ</a>へ行きます。<br>ログインして右上の歯車マークからアクセスできます。</p>
<p><img src="http://i.imgur.com/xFWbQJf.png" alt="Imgur"></p>
<p>次に、<code>Personal settings</code> から <code>SSH Keys</code> をクリックして <code>Add SSH Key</code> をクリックします。</p>
<p><img src="http://i.imgur.com/ljKoGUG.png" alt="Imgur"></p>
<p>適当にタイトルをつけて、SSH鍵を貼り付けます。 <code>Add Key</code> を押すと適用されます。</p>
<p><img src="http://i.imgur.com/wQMDFrh.png" alt="Imgur"></p>
<p>無事にSSH公開鍵が登録されるとこのようなページが表示されます。エラーが出たら変な空白とかが入っちゃってると思うので確認してみてください。</p>
<p><img src="http://i.imgur.com/k7wD2Gv.png" alt="Imgur"></p>
<h3 id="確認してみる">確認してみる</h3><p>以下コマンドで適当なディレクトリを作って、中に <code>index.html</code> を作成します。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir kusupite.github.io</span><br><span class="line">$ <span class="built_in">cd</span> kusupite.github.io/</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"Github Azunyan"</span> &gt; index.html</span><br></pre></td></tr></table></figure>
<p>作ったディレクトリをGithub上のリポジトリに紐付けます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ git init</span><br><span class="line">Initialized empty Git repository <span class="keyword">in</span> /root/kusupite.github.io/.git/</span><br><span class="line">$ git remote add origin git@github.com:kusupite/kusupite.github.i</span><br><span class="line">o.git</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>最後に、Github上にHTMLファイルをアップロードします。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">$ git add .</span><br><span class="line">$ git commit</span><br><span class="line">Aborting commit due to empty commit message.</span><br><span class="line">$ git commit -m <span class="string">"test"</span></span><br><span class="line">Committer: root &lt;root@localhost.localdomain&gt;</span><br><span class="line">Your name and email address were configured automatically based</span><br><span class="line">on your username and hostname. Please check that they are accurate.</span><br><span class="line">You can suppress this message by setting them explicitly:</span><br><span class="line"></span><br><span class="line">   git config --global user.name <span class="string">"Your Name"</span></span><br><span class="line">   git config --global user.email you@example.com</span><br><span class="line"></span><br><span class="line">After doing this, you may fix the identity used <span class="keyword">for</span> this commit with:</span><br><span class="line"></span><br><span class="line">   git commit --amend --reset-author</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> file changed, <span class="number">1</span> insertion(+)</span><br><span class="line">create mode <span class="number">100644</span> index.html</span><br><span class="line"><span class="comment"># git push origin master</span></span><br><span class="line">The authenticity of host <span class="string">'github.com (192.30.252.129)'</span> can<span class="string">'t be established.</span><br><span class="line">RSA key fingerprint is 16:27:ac:a5:76:28:2d:36:63:1b:56:4d:eb:df:a6:48.</span><br><span class="line">Are you sure you want to continue connecting (yes/no)? yes</span><br><span class="line">Warning: Permanently added '</span>github.com,<span class="number">192.30</span>.<span class="number">252.129</span><span class="string">' (RSA) to the list of known hosts.</span><br><span class="line">Counting objects: 3, done.</span><br><span class="line">Writing objects: 100% (3/3), 219 bytes | 0 bytes/s, done.</span><br><span class="line">Total 3 (delta 0), reused 0 (delta 0)</span><br><span class="line">To git@github.com:kusupite/kusupite.github.io.git</span><br><span class="line"> * [new branch]      master -&gt; master</span><br><span class="line">$</span></span><br></pre></td></tr></table></figure>
<p>これで無事にアップロードされましたはずです。 <code>http://ユーザ名.github.io</code> にアクセスしてみましょう。</p>
<p><img src="http://i.imgur.com/AFyBNUr.png" alt="Imgur"></p>
<p>イエーイ！満点！</p>
<h2 id="おわり">おわり</h2><p>Q.今週のHexoどうだった？<br>A.今週もHexo登場しなかった</p>
<h2 id="参考サイト様">参考サイト様</h2><blockquote>
<p>Git初心者でも大丈夫！完全無料でGithub PagesにWebページを公開する方法<br><a href="http://liginc.co.jp/web/html-css/html/96453" target="_blank" rel="external">http://liginc.co.jp/web/html-css/html/96453</a></p>
</blockquote>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="はじめに">はじめに</h2><p><a href="http://pitekusu.github.io/2015/05/08/GitHub%E3%81%A8Hexo%E3%81%8C%E7%81%AB%E3%82%92%E5%99%B4%E3%81%84%E3%81%9F3/">前回</a>で、  Hexoをインストールする準備が終わりました。いよいよHexoをインストールかと思いきや、Github Pagesの作成をしてなかったので、まずそれをやりたいと思います。</p>]]>
    
    </summary>
    
      <category term="Linux" scheme="http://pitekusu.github.io/tags/Linux/"/>
    
      <category term="github" scheme="http://pitekusu.github.io/tags/github/"/>
    
      <category term="技術" scheme="http://pitekusu.github.io/categories/%E6%8A%80%E8%A1%93/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[GitHubとHexoが火を噴いた(第3回)]]></title>
    <link href="http://pitekusu.github.io/2015/05/08/GitHub%E3%81%A8Hexo%E3%81%8C%E7%81%AB%E3%82%92%E5%99%B4%E3%81%84%E3%81%9F3/"/>
    <id>http://pitekusu.github.io/2015/05/08/GitHubとHexoが火を噴いた3/</id>
    <published>2015-05-08T06:46:33.000Z</published>
    <updated>2015-05-14T05:53:20.000Z</updated>
    <content type="html"><![CDATA[<h2 id="はじめに">はじめに</h2><p><a href="http://pitekusu.github.io/2015/04/23/GitHub%E3%81%A8Hexo%E3%81%8C%E7%81%AB%E3%82%92%E5%99%B4%E3%81%84%E3%81%9F2/" target="_blank" rel="external">第2回</a>でLinuxの基本設定まで終えました。ついに満を持してHexoのインストールと参ります、</p>
<a id="more"></a>
<h2 id="と思ったらnode-jsいれなきゃ">と思ったらnode.jsいれなきゃ</h2><p>Hexoをインストールする前にハイパーすごいと噂のnode.jsをインストールします。<br>あと今日は恐らく準備で私が力尽きます。</p>
<h3 id="NVMのインストール">NVMのインストール</h3><p>node.jsのバージョン管理に便利（らしい）、NVM(Node Version Manager)を先に入れておきます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ yum -y install git</span><br><span class="line"></span><br><span class="line">~省略~</span><br><span class="line"></span><br><span class="line">$ git <span class="built_in">clone</span> git://github.com/creationix/nvm.git ~/.nvm</span><br><span class="line">Cloning into <span class="string">'/root/.nvm'</span>...</span><br><span class="line">remote: Counting objects: <span class="number">3628</span>, done.</span><br><span class="line">remote: Compressing objects: <span class="number">100</span>% (<span class="number">3</span>/<span class="number">3</span>), done.</span><br><span class="line">remote: Total <span class="number">3628</span> (delta <span class="number">0</span>), reused <span class="number">0</span> (delta <span class="number">0</span>), pack-reused <span class="number">3625</span></span><br><span class="line">Receiving objects: <span class="number">100</span>% (<span class="number">3628</span>/<span class="number">3628</span>), <span class="number">777.24</span> KiB | <span class="number">432.00</span> KiB/s, done.</span><br><span class="line">Resolving deltas: <span class="number">100</span>% (<span class="number">2084</span>/<span class="number">2084</span>), done.</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">source</span> ~/.nvm/nvm.sh</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>以上でインストール完了です。確認してみます。ヘルプが表示されればOKです。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ nvm <span class="built_in">help</span></span><br><span class="line"></span><br><span class="line">Node Version Manager</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  nvm <span class="built_in">help</span>                              Show this message</span><br><span class="line">~省略~</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h3 id="Node-jsのインストール">Node.jsのインストール</h3><p>やっとNode.jsをインストールします。さっき入れたnvmコマンドを使用します。導入するNode.jsのバージョンを確認するため、以下のコマンドを入力します。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ nvm ls-remote</span><br><span class="line">v0.<span class="number">1.14</span></span><br><span class="line">v0.<span class="number">1.15</span></span><br><span class="line">v0.<span class="number">1.16</span></span><br><span class="line">v0.<span class="number">1.17</span></span><br><span class="line">~省略~</span><br><span class="line">v0.<span class="number">11.16</span></span><br><span class="line">v0.<span class="number">12.0</span></span><br><span class="line">v0.<span class="number">12.1</span></span><br><span class="line">v0.<span class="number">12.2</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>Node.jsは偶数のバージョンが安定版で、奇数のバージョンが開発版です。<br>この記事を書いているときはv0.12.2が最新の安定板だったので、これを導入することにします。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ nvm install <span class="number">0.12</span>.<span class="number">2</span></span><br><span class="line"><span class="comment">######################################################################## 100.0%</span></span><br><span class="line">Now using node v0.<span class="number">12.2</span> (npm v2.<span class="number">7.4</span>)</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>ちゃんとインストールできているか確認します。バージョンが表示されれればOKです。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ node -v</span><br><span class="line">v0.<span class="number">12.2</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h3 id="NVMを設定しておく">NVMを設定しておく</h3><p>さっき設定したのを、CentOS再起動後も使えるようにしておきます。<br>まず、デフォルトのNode.jsのバージョンを指定します。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ nvm <span class="built_in">alias</span> default <span class="number">0.12</span>.<span class="number">2</span></span><br><span class="line">default -&gt; <span class="number">0.12</span>.<span class="number">2</span> (-&gt; v0.<span class="number">12.2</span>)</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>nvmもログアウトすると使えなくなるので、<code>~/.bash_profile</code>に記載しておきます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ vi ~/.bash_profile</span><br><span class="line"><span class="keyword">if</span> [[ <span class="operator">-s</span> ~/.nvm/nvm.sh ]];</span><br><span class="line"> <span class="keyword">then</span> <span class="built_in">source</span> ~/.nvm/nvm.sh</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>これで次回再起動後もNVMとNode.jsが使用できます。</p>
<h2 id="Hello_Worldするかしら">Hello Worldするかしら</h2><p>webブラウザにHello Worldを表示してみます。ちゃんと出てきたら満点といえます。<br>viかなんかで”example.js”というファイルを作って以下のスクリプトを記述します。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ vi example.js</span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"></span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span> <span class="params">(request, response)</span> </span>&#123;</span><br><span class="line">  response.writeHead(<span class="number">200</span>, &#123;<span class="string">'Content-Type'</span>: <span class="string">'text/plain'</span>&#125;);</span><br><span class="line">  response.end(<span class="string">'Hello Azunyan\n'</span>);</span><br><span class="line">&#125;).listen(<span class="number">8124</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'Server running at http://127.0.0.1:8124/'</span>);</span><br></pre></td></tr></table></figure>
<p>そして、以下のコマンドでサーバを起動してみます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ node example.js</span><br><span class="line">Server running at http://<span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">8124</span>/</span><br></pre></td></tr></table></figure>
<p>実際にwebブラウザで接続してみます。</p>
<p><img src="http://i.imgur.com/sHyGAIJ.png?1" alt="Hello Azunyan"></p>
<p>問題なく表示されたら成功です！</p>
<h2 id="おわり">おわり</h2><p>次で！ついに！Hexoをインストールすることにします！長いなながいにゃん</p>
<h2 id="参考サイト様">参考サイト様</h2><blockquote>
<p>いまアツいJavaScript！ゼロから始めるNode.js入門〜5分で環境構築編〜<br><a href="http://liginc.co.jp/web/programming/node-js/85318" target="_blank" rel="external">http://liginc.co.jp/web/programming/node-js/85318</a></p>
</blockquote>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="はじめに">はじめに</h2><p><a href="http://pitekusu.github.io/2015/04/23/GitHub%E3%81%A8Hexo%E3%81%8C%E7%81%AB%E3%82%92%E5%99%B4%E3%81%84%E3%81%9F2/">第2回</a>でLinuxの基本設定まで終えました。ついに満を持してHexoのインストールと参ります、</p>]]>
    
    </summary>
    
      <category term="Linux" scheme="http://pitekusu.github.io/tags/Linux/"/>
    
      <category term="Node.js" scheme="http://pitekusu.github.io/tags/Node-js/"/>
    
      <category term="技術" scheme="http://pitekusu.github.io/categories/%E6%8A%80%E8%A1%93/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[GitHubとHexoが火を噴いた(第2回)]]></title>
    <link href="http://pitekusu.github.io/2015/04/23/GitHub%E3%81%A8Hexo%E3%81%8C%E7%81%AB%E3%82%92%E5%99%B4%E3%81%84%E3%81%9F2/"/>
    <id>http://pitekusu.github.io/2015/04/23/GitHubとHexoが火を噴いた2/</id>
    <published>2015-04-23T08:50:33.000Z</published>
    <updated>2015-05-14T07:15:23.000Z</updated>
    <content type="html"><![CDATA[<h2 id="はじめに">はじめに</h2><p><a href="http://pitekusu.github.io/2015/04/22/GitHub%E3%81%A8Hexo%E3%81%8C%E7%81%AB%E3%82%92%E5%99%B4%E3%81%84%E3%81%9F/" target="_blank" rel="external">前回の記事</a>で、GithubとHexoについてちらっと調べてみました。今回はGithub Pagesで実際にサイトを開設しようと思います。<strong>と思いましたが、</strong> Github Pagesにしても、Hexoにしても基本的にはLinux環境が必要になるので、しょぼい仮想マシンを構築しちゃいます。重い処理も容量も必要ないので本当にゴミみたいな仮想マシンで問題ないでしょう。しかし、私は <strong>あずにゃんESXiサーバ</strong> という小さくても頑張ってるサーバを構築していますので、こちらに仮想マシンを設置していきたいと思います。</p>
<a id="more"></a>
<p>ちなみにあずにゃんESXiサーバの外観はこれ。<br><img src="http://i.imgur.com/WC8DA2k.jpg" alt="あずにゃんESXi"></p>
<p>Intel製NUCです。手のひらサイズですが、中に16GBのメモリを積んでおります。HDDやSSDは積んでいませんが、ネットワーク経由で共有ストレージをデータストアとして使用しています。上に鎮座しているあずにゃんによって日々の保守運用がなされているのです！！！！</p>
<h2 id="仮想マシンを作る！">仮想マシンを作る！</h2><p>ESXiはハイパーバイザ型の仮想化ソフトです。なので巷でよく使用されるようなVmware Player等といったようにWindows上で動作するのではなく、ESXiというソフトの上で動きます。WindowsからESXiにアクセスするには何らかのクライアントを使用する必要があります。vSphere5くらいから、vCenterServerがあるのであればWeb Clientを使用するのが推奨となっているようです。ただしWebClientは動作が遅いことからあまり人気が無い様子。今後に期待です。</p>
<h3 id="ログイン">ログイン</h3><p>折角なのでWebClientを使ってログインします。<br><img src="http://i.imgur.com/krxbslx.png" alt="ログイン画面"></p>
<p>この通りかなりおしゃれです。私は何を隠そうログイン画面フェチでして、かっこいいログイン画面を見るのがかなり、非常に好きです。ログイン画面がかっこいいだけでそのソフトを導入したくなります。VMware製品は製品名もかっこいいのでうれしい限り。</p>
<h3 id="仮想マシンの準備">仮想マシンの準備</h3><p>ログインすると、こんな画面が出てきます。<br><img src="http://i.imgur.com/uQeXqOA.png" alt="ログイン後"></p>
<p>左側に既に作成済みの仮想マシンが並んでいます。<br>16GBのメモリを積んでいるといっても、所詮はNUCなので普段使わない仮想マシンの電源は落としています。</p>
<p><img src="http://i.imgur.com/ZndyNsT.png" alt="新規作成1"></p>
<p>仮想マシンの新規作成を選ぶとウィザードが起動してきます。まず新規仮想マシンの名前を付けます。適当に「Blog用マシン」としました。</p>
<p><img src="http://i.imgur.com/8m0ioha.png" alt="新規作成2"></p>
<p>仮想マシンを保存するデータストアを選択します。今見えてきている”DataStore”っていうやつは、あずにゃんストレージというキュートな共有ストレージです。私の場合は1個しかないのでそのまま次へ。</p>
<p><img src="http://i.imgur.com/BgTlcHA.png" alt="新規作成3"></p>
<p>ここですかさずLinuxを選択します。CentOSが大好きなので今回はCentOSでいきます。多分、なんでも大丈夫です。</p>
<p><img src="http://i.imgur.com/xFp7K6V.png" alt="新規作成4"><br><img src="http://i.imgur.com/Ta3qJUi.png" alt="新規作成5"></p>
<p>ここで色々な設定をします。まったくもって低スペックで問題ないので基本デフォルトにしました。変更したのはプロビジョニング方法を”Thin Provisioning”に変えたのと、NICアダプタタイプをE1000からVMXNET3に変えたくらいです。あとは起動時にISOイメージを読み込むように設定したくらいです。</p>
<p>“Thin Provisioning”にすることで容量を最初からすべて確保するわけではなく、必要になった時に都度確保するようになりディスクスペースの節約ができます。</p>
<p>NICに関しては基本的にはVMXNET3に変えるのが普通だと思います。”VMware Tools”というツールをインストールする必要がありますが（CentOS 7は必要無し）、特に問題なければVMXNET3でいきます。</p>
<p><img src="http://i.imgur.com/Cw9gxPy.png" alt="新規作成5"></p>
<p>仮想マシンのツリーに、作成した”Blog用マシン”が登場しました。これで準備OKです。実に簡単！</p>
<h2 id="Linux_(CentOS7)の準備">Linux (CentOS7)の準備</h2><p>ここまで来たら、vSphere Clientの仕事はほぼ終了ですが、SSH接続するまではvSphere上で作業します。Webアプリですが、なかなかよくできていてWeb上からコンソールを開いて作業することができます。以下がその画面になります。</p>
<h3 id="CentOS7のインストール">CentOS7のインストール</h3><p><img src="http://i.imgur.com/wzCM5Qd.png" alt="インストール1"></p>
<p>Web上でCentOS7のインストーラが起動し始めているのがわかります。うーん先進的です。</p>
<p><img src="http://i.imgur.com/RahI0r0.png" alt="インストール2"></p>
<p>GUIの画面ですね。わかりやすいです。Linuxは全く詳しくないので何も弄りませんが、ネットワークにつながってないとあれなんでそこだけ設定します（後でコマンドで設定しても何ら問題ないです）。</p>
<p><img src="http://i.imgur.com/f99oOQx.png" alt="インストール3"></p>
<p>何も考えずIPアドレスを設定します。DHCPでもいいかもしれませんが、SSHで接続することを考えると固定がいいんじゃないでしょうか。</p>
<p><img src="http://i.imgur.com/j8s2P9Y.png" alt="インストール4"></p>
<p>全般タブで自動的に接続するように変えておきます。</p>
<p><img src="http://i.imgur.com/sqBCGkD.png" alt="インストール5"></p>
<p>インストールが始まりました。rootパスワードだけ変えておきます。インストール中に設定変えるんですね。効率が良い。</p>
<p><img src="http://i.imgur.com/y3pzAfm.png" alt="インストール6"></p>
<p>インストールが終わるとログインを促すプロンプトが表示されます。これにてインストール完了でゲソ。SSHで接続できるのでvSphereは終了です。</p>
<h3 id="CentOS7の基本設定">CentOS7の基本設定</h3><p>今回はセキュリティのことなんて何も考えていない設定です。今回は恐らくファイアウォールもSELinuxも停止する必要はないです。備忘録として書き留めておきます。</p>
<h4 id="ファイアウォールの停止・無効">ファイアウォールの停止・無効</h4><p>以下コマンドでファイアウォールの状態を確認します。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl status firewalld</span><br><span class="line">firewalld.service - firewalld - dynamic firewall daemon</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/firewalld.service; enabled)</span><br><span class="line">   Active: active (running) since 木 <span class="number">2015</span>-<span class="number">04</span>-<span class="number">23</span> <span class="number">17</span>:<span class="number">46</span>:<span class="number">01</span> JST; <span class="number">1</span> weeks <span class="number">6</span> days ago</span><br><span class="line"> Main PID: <span class="number">560</span> (firewalld)</span><br><span class="line">   CGroup: /system.slice/firewalld.service</span><br><span class="line">           mq560 /usr/bin/python -Es /usr/sbin/firewalld --nofork --nopid</span><br><span class="line"></span><br><span class="line"> <span class="number">4</span>月 <span class="number">23</span> <span class="number">17</span>:<span class="number">46</span>:<span class="number">01</span> localhost.localdomain systemd[<span class="number">1</span>]: Started firewalld - dynamic firewall daemon.</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>現在はactive(running)とあります。これを停止させてみます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl stop firewalld</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>もう一度ファイアウォールの状態を確認してみます。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl status firewalld</span><br><span class="line">firewalld.service - firewalld - dynamic firewall daemon</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/firewalld.service; enabled)</span><br><span class="line">   Active: inactive (dead) since 木 <span class="number">2015</span>-<span class="number">05</span>-<span class="number">07</span> <span class="number">09</span>:<span class="number">38</span>:<span class="number">06</span> JST; <span class="number">17</span>min ago</span><br><span class="line">  Process: <span class="number">560</span> ExecStart=/usr/sbin/firewalld --nofork --nopid <span class="variable">$FIREWALLD_ARGS</span> (code=exited, status=<span class="number">0</span>/SUCCESS)</span><br><span class="line"> Main PID: <span class="number">560</span> (code=exited, status=<span class="number">0</span>/SUCCESS)</span><br><span class="line"></span><br><span class="line"> <span class="number">4</span>月 <span class="number">23</span> <span class="number">17</span>:<span class="number">46</span>:<span class="number">01</span> localhost.localdomain systemd[<span class="number">1</span>]: Started firewalld - dynamic firewall daemon.</span><br><span class="line"> <span class="number">5</span>月 <span class="number">07</span> <span class="number">09</span>:<span class="number">38</span>:<span class="number">06</span> localhost.localdomain systemd[<span class="number">1</span>]: Stopping firewalld - dynamic firewall daemon...</span><br><span class="line"> <span class="number">5</span>月 <span class="number">07</span> <span class="number">09</span>:<span class="number">38</span>:<span class="number">06</span> localhost.localdomain systemd[<span class="number">1</span>]: Stopped firewalld - dynamic firewall daemon.</span><br><span class="line">Hint: Some lines were ellipsized, use <span class="operator">-l</span> to show <span class="keyword">in</span> full.</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>今度はinactive(dead)となっています。ただし、Loadedの部分を見ると、enabledと記載されています。このままだと、システムを再起動するとファイアウォールが有効化されてしまいます。</p>
<p>次回起動時にも無効化されているように、次のコマンドを入力しておきます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl <span class="built_in">disable</span> firewalld</span><br><span class="line">rm <span class="string">'/etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service'</span></span><br><span class="line">rm <span class="string">'/etc/systemd/system/basic.target.wants/firewalld.service'</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>以上でファイアウォールを無効化できました。<br>一応確認しておきます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl status firewalld <span class="operator">-l</span></span><br><span class="line">firewalld.service - firewalld - dynamic firewall daemon</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/firewalld.service; disabled)</span><br><span class="line">   Active: inactive (dead)</span><br><span class="line"></span><br><span class="line"> <span class="number">4</span>月 <span class="number">23</span> <span class="number">17</span>:<span class="number">45</span>:<span class="number">59</span> localhost.localdomain systemd[<span class="number">1</span>]: Starting firewalld - dynamic firewall daemon...</span><br><span class="line"> <span class="number">4</span>月 <span class="number">23</span> <span class="number">17</span>:<span class="number">46</span>:<span class="number">01</span> localhost.localdomain systemd[<span class="number">1</span>]: Started firewalld - dynamic firewall daemon.</span><br><span class="line"> <span class="number">5</span>月 <span class="number">07</span> <span class="number">09</span>:<span class="number">38</span>:<span class="number">06</span> localhost.localdomain systemd[<span class="number">1</span>]: Stopping firewalld - dynamic firewall daemon...</span><br><span class="line"> <span class="number">5</span>月 <span class="number">07</span> <span class="number">09</span>:<span class="number">38</span>:<span class="number">06</span> localhost.localdomain systemd[<span class="number">1</span>]: Stopped firewalld - dynamic firewall daemon.</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>Loaded部分がdisabledに変わりました。問題なさそうです。</p>
<h4 id="SELinuxの停止・無効">SELinuxの停止・無効</h4><p>まず、SELinuxの動作状態を確認してみます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ getenforce</span><br><span class="line">Enforcing</span><br></pre></td></tr></table></figure>
<p>SELinuxの動作モードは以下の3つになります。</p>
<table>
<thead>
<tr>
<th style="text-align:left">動作モード</th>
<th>意味</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Enforcing</td>
<td>SELinuxが有効</td>
</tr>
<tr>
<td style="text-align:left">Permissive</td>
<td>SELinuxのチェックはするけどアクセス拒否はしない</td>
</tr>
<tr>
<td style="text-align:left">disabled</td>
<td>SELinuxが無効</td>
</tr>
</tbody>
</table>
<p>現在はEnforcingなので、SELinuxが有効状態です。以下のコマンドで停止させます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ setenforce <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>再度確認します。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ gentenfoce</span><br><span class="line">Permissive</span><br></pre></td></tr></table></figure>
<p>SELinuxもこのままだと再起動後に復活するので、無効化しておきます。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ vi /etc/sysconfig/selinux</span><br><span class="line"></span><br><span class="line"><span class="comment"># This file controls the state of SELinux on the system.</span></span><br><span class="line"><span class="comment"># SELINUX= can take one of these three values:</span></span><br><span class="line"><span class="comment">#     enforcing - SELinux security policy is enforced.</span></span><br><span class="line"><span class="comment">#     permissive - SELinux prints warnings instead of enforcing.</span></span><br><span class="line"><span class="comment">#     disabled - No SELinux policy is loaded.</span></span><br><span class="line">SELINUX=disabled</span><br></pre></td></tr></table></figure>
<p>これでシステムを再起動し、再度確認します。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ gentenfoce</span><br><span class="line">Disabled</span><br></pre></td></tr></table></figure>
<p>完璧に無効化されました。<br>あとは<code>yum update</code>とかしたらいいんじゃないでしょうか。</p>
<p>次回はHexoを実際にインストールします。<br>あずにゃん</p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="はじめに">はじめに</h2><p><a href="http://pitekusu.github.io/2015/04/22/GitHub%E3%81%A8Hexo%E3%81%8C%E7%81%AB%E3%82%92%E5%99%B4%E3%81%84%E3%81%9F/">前回の記事</a>で、GithubとHexoについてちらっと調べてみました。今回はGithub Pagesで実際にサイトを開設しようと思います。<strong>と思いましたが、</strong> Github Pagesにしても、Hexoにしても基本的にはLinux環境が必要になるので、しょぼい仮想マシンを構築しちゃいます。重い処理も容量も必要ないので本当にゴミみたいな仮想マシンで問題ないでしょう。しかし、私は <strong>あずにゃんESXiサーバ</strong> という小さくても頑張ってるサーバを構築していますので、こちらに仮想マシンを設置していきたいと思います。</p>]]>
    
    </summary>
    
      <category term="ESXi" scheme="http://pitekusu.github.io/tags/ESXi/"/>
    
      <category term="Linux" scheme="http://pitekusu.github.io/tags/Linux/"/>
    
      <category term="VMware" scheme="http://pitekusu.github.io/tags/VMware/"/>
    
      <category term="技術" scheme="http://pitekusu.github.io/categories/%E6%8A%80%E8%A1%93/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[GitHubとHexoが火を噴いた(第1回)]]></title>
    <link href="http://pitekusu.github.io/2015/04/22/GitHub%E3%81%A8Hexo%E3%81%8C%E7%81%AB%E3%82%92%E5%99%B4%E3%81%84%E3%81%9F/"/>
    <id>http://pitekusu.github.io/2015/04/22/GitHubとHexoが火を噴いた/</id>
    <published>2015-04-22T13:25:33.000Z</published>
    <updated>2015-04-22T16:01:52.000Z</updated>
    <content type="html"><![CDATA[<h2 id="はじめに">はじめに</h2><p>最近は会社が大変ヒマでして、社内ニートな私にとって技術の勉強をしているように見せかけつつ趣味に走ることがマイブームとなっております。そんな私に与えられたおもちゃは仮想環境であるVmware社のESXi。そしてネット環境。いろいろ試してみたくなっちゃいます。</p>
<a id="more"></a>
<h3 id="そういえば最近ブログ更新してないな～">そういえば最近ブログ更新してないな～</h3><p>昔、Googleサイトでブログチックなサイトを開設したのですが、いかんせん管理が難しくすぐに挫折してしまいました。そこで今回暇つぶしにネット見てたら見つけたのがこの2つの組み合わせ。</p>
<ul>
<li>Github</li>
<li>Hexo</li>
</ul>
<p>どっちもきいたことがない！Githubっていうのはたま～にエンジニアの皆様のツイートでお見かけするのですが、Hexoっていうのは全くわからん！ということで一から調べることにしました。</p>
<h2 id="GithubとHexoについて調べてみた">GithubとHexoについて調べてみた</h2><h3 id="Github">Github</h3><p><a href="https://github.com" target="_blank" rel="external"><img src="http://i.imgur.com/oQ0F5OD.png" alt="GitHubの公式ページ"></a></p>
<blockquote>
<p>GitHub（ギットハブ）はソフトウェア開発プロジェクトのための共有ウェブサービスであり、Gitバージョン管理システムを使用する。<br><a href="http://ja.wikipedia.org/wiki/GitHub" target="_blank" rel="external">Github(ウィキペディア)</a>  </p>
</blockquote>
<hr>
<p>そう！そういう話は聞いたことありました。でもそれってブログと関係ねえじゃん？どういうことでしょうか。<br>もう少し調べてみたら、Githubのサービスの中に<a href="https://pages.github.com" target="_blank" rel="external">Github Pages</a>なるものがあることが判明。こいつは昔流行ったWebのレンタルサーバに似てるようだ。そしてその特徴がこちら。</p>
<ul>
<li>無料！</li>
<li>広告なし！</li>
<li>容量無制限！らしい（一応制限はあるらしいけどソフトクォータ的な制限とのこと）</li>
<li>独自ドメインにできる！→これに関しては元のドメインがかっこいいから私はこのままいきます</li>
<li>静的ページのみ対応</li>
</ul>
<p>素敵です！昔私はInfoseekでゴミみたいなページを公開して黒歴史化したので、こういったサービスがあるとまた歴史を繰り返したくなります！<br>ところで静的ページとはなんでしょうか？知らない言葉だらけです。軽く調べてみると、サーバサイド側の処理が必要なものっぽい？PHPとかのことでしょうか。こういうのが使えないって思うとかっちょいいページは作れないのかなと思ったのですが、最近はそうではないようです。<br>どうやらチョベリグ静的ページを簡単に実現するのが<strong>Hexo</strong>というもののようだ！</p>
<h3 id="Hexo">Hexo</h3><p><a href="https://hexo.io" target="_blank" rel="external"><img src="http://i.imgur.com/i5Y0XNE.png" alt="hexoの公式ページ"></a></p>
<blockquote>
<p>A fast, simple &amp; powerful blog framework  </p>
</blockquote>
<hr>
<p>速くてシンプルで強力とは！相当凄いに違いありません。<br>Hexoというのは静的サイトジェネレータというサービスの1つらしく、PHP等を使うことなく、クライアントサイド側の処理のみで死ぬほど簡単に洒落たページが作れるようです。また、静的ページなので動作も高速とのこと。これはいいぞ～<br>さらに作ったページを他のホスティングサービスにデプロイして公開することも簡単にできるとのこと。なるほど、ここでGithub Pagesがでできるわけですね。<br>一番人気のある静的サイトジェネレータは<a href="http://jekyllrb.com/" target="_blank" rel="external">Jekyll</a>  というものらしいのですが、静的サイトジェネレータを知ったきっかけがHexoだったので、今回はHexoでいきます。  </p>
<p>静的サイトジェネレータには、大きく分けてRubyかJavaScriptで作られているようです。今回採用したHexoはJavaScriptで作られており、Rubyを新たに導入する必要はなさそうです。楽です。  </p>
<p>そしてHexoの特徴はこちら。</p>
<ul>
<li>コマンドがめっちゃ簡単</li>
<li>マークダウンをサポート。これ嬉しい！</li>
<li>テーマ（デザインのテンプレート）がたくさんある</li>
<li>JavaScript製<strong>(node.js)</strong></li>
</ul>
<p>ここで出てきた<a href="https://nodejs.org" target="_blank" rel="external">node.js</a>  というのが画期的なものらしく、私は全く専門外なので何もわかりませんがとにかくすごいということはわかりました。JavaScriptだけどサーバサイドで処理するってことだけわかった。普通のJavaScriptさえろくにかけない私にとっては完全に魔法の世界です。</p>
<h2 id="次回">次回</h2><p>GithubにサインアップしてGithub Pagesにリポジトリを作成しようと思います。まだMarkdown記述になれていないので時間がかかっていますが、だんだん慣れてくれば早く描けるようになってくるでしょう。それではまた次回お会いしましょう。<strong><em>あずにゃん可愛い</em></strong></p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="はじめに">はじめに</h2><p>最近は会社が大変ヒマでして、社内ニートな私にとって技術の勉強をしているように見せかけつつ趣味に走ることがマイブームとなっております。そんな私に与えられたおもちゃは仮想環境であるVmware社のESXi。そしてネット環境。いろいろ試してみたくなっちゃいます。</p>]]>
    
    </summary>
    
      <category term="Linux" scheme="http://pitekusu.github.io/tags/Linux/"/>
    
      <category term="Webサービス" scheme="http://pitekusu.github.io/tags/Web%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9/"/>
    
      <category term="技術" scheme="http://pitekusu.github.io/categories/%E6%8A%80%E8%A1%93/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[GitHubとHexoが火を噴いた(第1回)]]></title>
    <link href="http://pitekusu.github.io/2015/04/22/GitHub%E3%81%A8Hexo%E3%81%8C%E7%81%AB%E3%82%92%E5%99%B4%E3%81%84%E3%81%9F0/"/>
    <id>http://pitekusu.github.io/2015/04/22/GitHubとHexoが火を噴いた0/</id>
    <published>2015-04-22T13:25:33.000Z</published>
    <updated>2015-05-19T02:57:12.000Z</updated>
    <content type="html"><![CDATA[<h2 id="はじめに">はじめに</h2><p>最近は会社が大変ヒマでして、社内ニートな私にとって技術の勉強をしているように見せかけつつ趣味に走ることがマイブームとなっております。そんな私に与えられたおもちゃは仮想環境であるVmware社のESXi。そしてネット環境。いろいろ試してみたくなっちゃいます。</p>
<a id="more"></a>
<h3 id="そういえば最近ブログ更新してないな～">そういえば最近ブログ更新してないな～</h3><p>昔、Googleサイトでブログチックなサイトを開設したのですが、いかんせん管理が難しくすぐに挫折してしまいました。そこで今回暇つぶしにネット見てたら見つけたのがこの2つの組み合わせ。</p>
<ul>
<li>Github</li>
<li>Hexo</li>
</ul>
<p>どっちもきいたことがない！Githubっていうのはたま～にエンジニアの皆様のツイートでお見かけするのですが、Hexoっていうのは全くわからん！ということで一から調べることにしました。</p>
<h2 id="GithubとHexoについて調べてみた">GithubとHexoについて調べてみた</h2><h3 id="Github">Github</h3><p><a href="https://github.com" target="_blank" rel="external"><img src="http://i.imgur.com/oQ0F5OD.png" alt="GitHubの公式ページ"></a></p>
<blockquote>
<p>GitHub（ギットハブ）はソフトウェア開発プロジェクトのための共有ウェブサービスであり、Gitバージョン管理システムを使用する。<br><a href="http://ja.wikipedia.org/wiki/GitHub" target="_blank" rel="external">Github(ウィキペディア)</a>  </p>
</blockquote>
<hr>
<p>そう！そういう話は聞いたことありました。でもそれってブログと関係ねえじゃん？どういうことでしょうか。<br>もう少し調べてみたら、Githubのサービスの中に<a href="https://pages.github.com" target="_blank" rel="external">Github Pages</a>なるものがあることが判明。こいつは昔流行ったWebのレンタルサーバに似てるようだ。そしてその特徴がこちら。</p>
<ul>
<li>無料！</li>
<li>広告なし！</li>
<li>容量無制限！らしい（一応制限はあるらしいけどソフトクォータ的な制限とのこと）</li>
<li>独自ドメインにできる！→これに関しては元のドメインがかっこいいから私はこのままいきます</li>
<li>静的ページのみ対応</li>
</ul>
<p>素敵です！昔私はInfoseekでゴミみたいなページを公開して黒歴史化したので、こういったサービスがあるとまた歴史を繰り返したくなります！<br>ところで静的ページとはなんでしょうか？知らない言葉だらけです。軽く調べてみると、サーバサイド側の処理が必要なものっぽい？PHPとかのことでしょうか。こういうのが使えないって思うとかっちょいいページは作れないのかなと思ったのですが、最近はそうではないようです。<br>どうやらチョベリグ静的ページを簡単に実現するのが<strong>Hexo</strong>というもののようだ！</p>
<h3 id="Hexo">Hexo</h3><p><a href="https://hexo.io" target="_blank" rel="external"><img src="http://i.imgur.com/i5Y0XNE.png" alt="hexoの公式ページ"></a></p>
<blockquote>
<p>A fast, simple &amp; powerful blog framework  </p>
</blockquote>
<hr>
<p>速くてシンプルで強力とは！相当凄いに違いありません。<br>Hexoというのは静的サイトジェネレータというサービスの1つらしく、PHP等を使うことなく、クライアントサイド側の処理のみで死ぬほど簡単に洒落たページが作れるようです。また、静的ページなので動作も高速とのこと。これはいいぞ～<br>さらに作ったページを他のホスティングサービスにデプロイして公開することも簡単にできるとのこと。なるほど、ここでGithub Pagesがでできるわけですね。<br>一番人気のある静的サイトジェネレータは<a href="http://jekyllrb.com/" target="_blank" rel="external">Jekyll</a>  というものらしいのですが、静的サイトジェネレータを知ったきっかけがHexoだったので、今回はHexoでいきます。  </p>
<p>静的サイトジェネレータには、大きく分けてRubyかJavaScriptで作られているようです。今回採用したHexoはJavaScriptで作られており、Rubyを新たに導入する必要はなさそうです。楽です。  </p>
<p>そしてHexoの特徴はこちら。</p>
<ul>
<li>コマンドがめっちゃ簡単</li>
<li>マークダウンをサポート。これ嬉しい！</li>
<li>テーマ（デザインのテンプレート）がたくさんある</li>
<li>JavaScript製<strong>(node.js)</strong></li>
</ul>
<p>ここで出てきた<a href="https://nodejs.org" target="_blank" rel="external">node.js</a>  というのが画期的なものらしく、私は全く専門外なので何もわかりませんがとにかくすごいということはわかりました。JavaScriptだけどサーバサイドで処理するってことだけわかった。普通のJavaScriptさえろくにかけない私にとっては完全に魔法の世界です。</p>
<h2 id="次回">次回</h2><p>GithubにサインアップしてGithub Pagesにリポジトリを作成しようと思います。まだMarkdown記述になれていないので時間がかかっていますが、だんだん慣れてくれば早く描けるようになってくるでしょう。それではまた次回お会いしましょう。<strong><em>あずにゃん可愛い</em></strong></p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="はじめに">はじめに</h2><p>最近は会社が大変ヒマでして、社内ニートな私にとって技術の勉強をしているように見せかけつつ趣味に走ることがマイブームとなっております。そんな私に与えられたおもちゃは仮想環境であるVmware社のESXi。そしてネット環境。いろいろ試してみたくなっちゃいます。</p>]]>
    
    </summary>
    
      <category term="Linux" scheme="http://pitekusu.github.io/tags/Linux/"/>
    
      <category term="Webサービス" scheme="http://pitekusu.github.io/tags/Web%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9/"/>
    
      <category term="技術" scheme="http://pitekusu.github.io/categories/%E6%8A%80%E8%A1%93/"/>
    
  </entry>
  
</feed>